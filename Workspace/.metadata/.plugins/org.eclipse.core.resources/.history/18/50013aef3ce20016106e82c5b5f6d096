package com;

import java.io.IOException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import ch.gmtech.ste.learning.seminar.next.Course;
import ch.gmtech.ste.learning.seminar.next.PrintFactory;
import ch.gmtech.ste.learning.seminar.next.Seminar;
import ch.gmtech.ste.learning.seminar.next.Student;

@SuppressWarnings("serial")
public class Servlet extends HttpServlet {
	
	private PrintFactory _printFactory;
	
	public void setUp() throws ParseException {
		SimpleDateFormat sdf = new SimpleDateFormat("dd.MM.yyyy");
		Date startDate = sdf.parse("01.10.2016");
		Seminar seminar = new Seminar("Zurich", new Course("Computer science", 1, "Lorem ipsum dolor sit amet", startDate));
		seminar.enroll(new Student("Ugo", "Campione"));
		seminar.enroll(new Student("Sandra", "Bach"));
		_printFactory = new PrintFactory(seminar);
	}

	@Override
	protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
		
		if(req.getRequestURI().equals("/try/me")){
			resp.getWriter().write("<html><head><title>Computer science</title></head><body><div>Computer science:</div><ul><li>Lorem ipsum dolor sit amet iniziera' il 01.10.2016</li><li>Zurich</li><li>18</li></ul><div>partecipanti:</div><ul><li>Ugo Campione</li><li>Sandra Bach</li></ul></body></html>");
		}else if(req.getRequestURI().equals("/html")){
			try {
				resp.getWriter().write(_printFactory.printHtml());
			} catch (ParseException e) {
				throw new RuntimeException(e);
			}
		}
	}
}
